<div class="header-container">
    <div class="home-icon">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        <polyline points="9 22 9 12 15 12 15 22"></polyline>
      </svg>
    </div>
    <div class="user-info">
      <span>Usuario: Bryan Alexander Baño Riofrio(Admin)</span>
    </div>
</div>
<!-- Agregar seleccionar Cliente -->
<div class="block-container">
  <h2 class="block-title">Agregar o Seleccionar un cliente</h2>
  
  <div class="block-content">
    <div class="input-group">
      <label for="documento">Ingrese el número del documento:</label>
      <div class="input-with-button">
        <input type="text" id="documento" placeholder="Ingrese documento" [(ngModel)]="documento">
        <button class="validar-btn" (click)="validarCliente()" [disabled]="cargandoCliente">
          <span *ngIf="!cargandoCliente">Validar</span>
          <span *ngIf="cargandoCliente">Cargando...</span>
        </button>
      </div>
    </div>

    <!-- Sección de información del cliente (condicional) -->
    <div class="info-section" *ngIf="mostrarInfoCliente && clienteActual">
      <div class="info-item">
        <p><strong>Nombre completo:</strong> {{clienteActual.nombreCompleto}}</p>
        <p><strong>Documento:</strong> {{clienteActual.documento}}</p>
        <p><strong>Estado:</strong> 
          <span *ngIf="clienteActual.esClienteActivo" style="color: green;">Activo</span>
          <span *ngIf="!clienteActual.esClienteActivo" style="color: orange;">Inactivo</span>
        </p>
      </div>
    </div>
    
    <!-- Botón de nuevo propietario (siempre visible) -->
    <div class="actions" style="margin-top: 15px;">
      <button class="action-btn" (click)="showDialog()" type="button">
        Registrar Nuevo Cliente
      </button>
    </div>
  </div>
</div>
<!-- Agregar seleccionar vehiculo -->
<div class="block-container">
  <h2 class="block-title">Agregar o Seleccionar un Vehículo</h2>
  
  <div class="block-content">
    <div class="input-group">
      <label for="placa">Ingrese el número de placa del vehículo:</label>
      <div class="input-with-button">
        <input type="text" id="placa" placeholder="Ingrese la placa" [(ngModel)]="placa">
        <button class="validar-btn" (click)="validarVehiculo()" [disabled]="cargandoVehiculo">
          <span *ngIf="!cargandoVehiculo">Validar</span>
          <span *ngIf="cargandoVehiculo">Cargando...</span>
        </button>
        <button class="secondary-btn" [disabled]="!vehiculoActual">Retirar propiedad</button>
      </div>
    </div>
    <div class="info-section" *ngIf="mostrarInfoVehiculo && vehiculoActual">
      <div class="info-item">
        <p><strong>Placa:</strong> {{vehiculoActual.placa}}</p>
        <p><strong>Marca:</strong> {{vehiculoActual.marca}}</p>
        <p><strong>Modelo:</strong> {{vehiculoActual.modelo}}</p>
        <p><strong>Último año de matriculación:</strong> {{vehiculoActual.ultimoAnioMatriculacion}}</p>
        <p><strong>Último año de RTV:</strong> {{vehiculoActual.ultimoAnioRTV}}</p>
        <p><strong>Estado:</strong> 
          <span *ngIf="vehiculoActual.estado == 0" style="color: green;">Operativo</span>
          <span *ngIf="vehiculoActual.estado == 1" style="color: orange;">En Mantenimiento</span>
          <span *ngIf="vehiculoActual.estado == 2" style="color: red;">De Baja</span>
        </p>
      </div>
    </div>
    
    <!-- Botón para nuevo vehículo (siempre visible) -->
    <div class="actions" style="margin-top: 15px;">
      <button class="action-btn" (click)="mostrarPopupVehiculo()">Nuevo Vehículo</button>
    </div>
  </div>
</div>
<!-- Servicio a realizar -->
<div class="service-container">
  <h2 class="service-title">Servicio a Realizar</h2>
  <div class="service-content">
    <div class="section-group">
      <h3 class="section-subtitle">Detalles del Servicio</h3>
      <div class="form-grid">
        <div class="form-group">
          <label for="descripcion">Descripción del mantenimiento:*</label>
          <textarea id="descripcion" rows="3" [(ngModel)]="ordenData.detalle" required placeholder="Describa detalladamente el mantenimiento a realizar"></textarea>
        </div>
        
        <div class="form-group">
          <label for="observacion">Observación General (opcional)*</label>
          <textarea id="observacion" rows="3" [(ngModel)]="ordenData.observacion" placeholder="Información adicional sobre el servicio"></textarea>
        </div>
      </div>
    </div>
    
    <div class="section-group">
      <h3 class="section-subtitle">Información Técnica</h3>
      <div class="form-grid">
        <div class="form-group">
          <label for="kilometraje">Kilometraje actual:*</label>
          <div class="input-with-unit">
            <input type="number" id="kilometraje" [(ngModel)]="ordenData.kilometraje" required placeholder="Ej: 15000">
            <span class="unit">km</span>
          </div>
        </div>
        
        <div class="form-group">
          <label for="fecha">Fecha programada:*</label>
          <div class="date-input">
            <input type="date" id="fecha" [(ngModel)]="ordenData.fechaProgramada" required>
            
          </div>
        </div>
      </div>
    </div>
    
    <div class="section-group">
      <h3 class="section-subtitle">Asignación y Prioridad</h3>
      <div class="form-grid">
        <!-- Mecánico Asignado con estado de carga -->
          <div class="form-group">
            <label for="mecanico">Mecánico Asignado (supervisor)*</label>
            <div class="select-wrapper">
              <select id="mecanico" [(ngModel)]="ordenData.idMecanico" required [disabled]="cargandoMecanicos">
                <option value="" disabled selected>
                  {{cargandoMecanicos ? 'Cargando mecánicos...' : 'Seleccionar mecánico...'}}
                </option>
                <option *ngFor="let mecanico of mecanicos" [value]="mecanico.idMecanico">
                  {{mecanico.nombre}}
                </option>
              </select>
              <div class="select-arrow" *ngIf="!cargandoMecanicos">▼</div>
              <div class="loading-indicator" *ngIf="cargandoMecanicos">
                <span class="spinner"></span>
              </div>
            </div>
          </div>
        
        <div class="form-group">
          <label for="prioridad">Prioridad de la Orden:*</label>
          <div class="select-wrapper">
            <select id="prioridad" [(ngModel)]="ordenData.prioridad" required>
              <option value="" disabled selected>Seleccionar prioridad...</option>
              <option [value]="0" class="priority-critical">Crítico</option>
              <option [value]="1" class="priority-emergency">Emergencia</option>
              <option [value]="2" class="priority-warning">Advertencia</option>
              <option [value]="3" class="priority-notification">Notificación</option>
              <option [value]="4" class="priority-low">Baja prioridad</option>
            </select>
            <div class="select-arrow">▼</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Sección de imágenes -->
    <div class="section-group">
      <h3 class="section-subtitle">Imágenes de Recepción del Vehículo</h3>
      <p class="section-description">Adjunte fotografías del vehículo para documentar su estado. Las imágenes se subirán después de crear la orden.</p>
      
      <div class="image-grid">
        <!-- Imagen Frontal (Ya implementada) -->
        <div class="image-upload-box" 
            [class.with-image]="previewFrontal"
            [class.dragover]="dragOverFrontal"
            (dragover)="onDragOver($event); dragOverFrontal = true"
            (dragleave)="dragOverFrontal = false"
            (drop)="onDrop($event, 'frontal'); dragOverFrontal = false">
          
          <h4>Frontal</h4>
          
          <!-- Vista previa cuando hay imagen -->
          <div class="image-preview" *ngIf="previewFrontal">
            <img [src]="previewFrontal" alt="Vista previa frontal">
            <button type="button" class="remove-image" (click)="eliminarImagen('frontal')">
              <i class="delete-icon">×</i>
            </button>
          </div>
          
          <!-- Área de drop cuando no hay imagen -->
          <ng-container *ngIf="!previewFrontal">
            <div class="image-icons">
              <div class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2"/>
                  <circle cx="8.5" cy="8.5" r="1.5"/>
                  <path d="M20.4 14.5L16 10 4 20"/>
                </svg>
              </div>
              <div class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                  <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
                </svg>
              </div>
              <div class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                </svg>
              </div>
            </div>
            <p class="drop-text">Arrastra una imagen aquí</p>
            <div class="action-buttons">
              <label class="browse-button">
                <span>Seleccionar</span>
                <input type="file" accept="image/*" (change)="onFileSelected($event, 'frontal')" style="display:none">
              </label>
              <!-- Modifica temporalmente esto -->
              <label class="camera-button"> <!-- Quitar *ngIf="isMobileDevice()" durante pruebas -->
                <span>Cámara</span>
                <input type="file" accept="image/*" capture="environment" (change)="onFileSelected($event, 'frontal')" style="display:none">
              </label>
            </div>
          </ng-container>
        </div>
        <!-- Imagen Lateral Izquierda -->
          <div class="image-upload-box" 
          [class.with-image]="previewLateralIzquierda"
          [class.dragover]="dragOverLateralIzquierda"
          (dragover)="onDragOver($event); dragOverLateralIzquierda = true"
          (dragleave)="dragOverLateralIzquierda = false"
          (drop)="onDrop($event, 'lateralIzquierda'); dragOverLateralIzquierda = false">

          <h4>Lateral Izquierda</h4>

          <!-- Vista previa cuando hay imagen -->
          <div class="image-preview" *ngIf="previewLateralIzquierda">
          <img [src]="previewLateralIzquierda" alt="Vista previa lateral izquierda">
          <button type="button" class="remove-image" (click)="eliminarImagen('lateralIzquierda')">
            <i class="delete-icon">×</i>
          </button>
          </div>

          <!-- Área de drop cuando no hay imagen -->
          <ng-container *ngIf="!previewLateralIzquierda">
          <div class="image-icons">
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <path d="M20.4 14.5L16 10 4 20"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
              </svg>
            </div>
          </div>
          <p class="drop-text">Arrastra una imagen aquí</p>
          <div class="action-buttons">
            <label class="browse-button">
              <span>Seleccionar</span>
              <input type="file" accept="image/*" (change)="onFileSelected($event, 'lateralIzquierda')" style="display:none">
            </label>
            <label class="camera-button">
              <span>Cámara</span>
              <input type="file" accept="image/*" capture="environment" (change)="onFileSelected($event, 'lateralIzquierda')" style="display:none">
            </label>
          </div>
          </ng-container>
          </div>

          <!-- Imagen Lateral Derecha -->
          <div class="image-upload-box" 
          [class.with-image]="previewLateralDerecha"
          [class.dragover]="dragOverLateralDerecha"
          (dragover)="onDragOver($event); dragOverLateralDerecha = true"
          (dragleave)="dragOverLateralDerecha = false"
          (drop)="onDrop($event, 'lateralDerecha'); dragOverLateralDerecha = false">

          <h4>Lateral Derecha</h4>

          <!-- Vista previa cuando hay imagen -->
          <div class="image-preview" *ngIf="previewLateralDerecha">
          <img [src]="previewLateralDerecha" alt="Vista previa lateral derecha">
          <button type="button" class="remove-image" (click)="eliminarImagen('lateralDerecha')">
            <i class="delete-icon">×</i>
          </button>
          </div>

          <!-- Área de drop cuando no hay imagen -->
          <ng-container *ngIf="!previewLateralDerecha">
          <div class="image-icons">
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <path d="M20.4 14.5L16 10 4 20"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
              </svg>
            </div>
          </div>
          <p class="drop-text">Arrastra una imagen aquí</p>
          <div class="action-buttons">
            <label class="browse-button">
              <span>Seleccionar</span>
              <input type="file" accept="image/*" (change)="onFileSelected($event, 'lateralDerecha')" style="display:none">
            </label>
            <label class="camera-button">
              <span>Cámara</span>
              <input type="file" accept="image/*" capture="environment" (change)="onFileSelected($event, 'lateralDerecha')" style="display:none">
            </label>
          </div>
          </ng-container>
          </div>

          <!-- Imagen Trasera -->
          <div class="image-upload-box" 
          [class.with-image]="previewTrasera"
          [class.dragover]="dragOverTrasera"
          (dragover)="onDragOver($event); dragOverTrasera = true"
          (dragleave)="dragOverTrasera = false"
          (drop)="onDrop($event, 'trasera'); dragOverTrasera = false">

          <h4>Trasera</h4>

          <!-- Vista previa cuando hay imagen -->
          <div class="image-preview" *ngIf="previewTrasera">
          <img [src]="previewTrasera" alt="Vista previa trasera">
          <button type="button" class="remove-image" (click)="eliminarImagen('trasera')">
            <i class="delete-icon">×</i>
          </button>
          </div>

          <!-- Área de drop cuando no hay imagen -->
          <ng-container *ngIf="!previewTrasera">
          <div class="image-icons">
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <path d="M20.4 14.5L16 10 4 20"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
              </svg>
            </div>
          </div>
          <p class="drop-text">Arrastra una imagen aquí</p>
          <div class="action-buttons">
            <label class="browse-button">
              <span>Seleccionar</span>
              <input type="file" accept="image/*" (change)="onFileSelected($event, 'trasera')" style="display:none">
            </label>
            <label class="camera-button">
              <span>Cámara</span>
              <input type="file" accept="image/*" capture="environment" (change)="onFileSelected($event, 'trasera')" style="display:none">
            </label>
          </div>
          </ng-container>
          </div>
      </div>
      <!-- Indicador de carga de imágenes -->
      <div class="upload-status" *ngIf="cargandoImagenes">
        <div class="progress-bar">
          <div class="progress" [style.width.%]="(imagenesSubidas / totalImagenes) * 100"></div>
        </div>
        <p>Subiendo imágenes: {{imagenesSubidas}} de {{totalImagenes}}</p>
      </div>
    </div>

    <!-- Agregar al final del servicio-container -->
    <div class="actions-container">
      <button type="button" class="cancel-btn" (click)="navegarInicio()" [disabled]="creandoOrden || cargandoImagenes">
        Cancelar
      </button>
      
      <button type="button" class="create-btn" [disabled]="creandoOrden || cargandoImagenes" (click)="crearOrdenTrabajo()">
        <span *ngIf="!creandoOrden && !cargandoImagenes">Crear Orden de Trabajo</span>
        <span *ngIf="creandoOrden && !cargandoImagenes">
          <span class="spinner"></span> Creando orden...
        </span>
        <span *ngIf="cargandoImagenes">
          <span class="spinner"></span> Subiendo imágenes... ({{imagenesSubidas}}/{{totalImagenes}})
        </span>
      </button>
    </div>
  </div>
</div>


<!-- Modal para Nuevo Propietario (Versión corregida) -->
<p-dialog  [(visible)]="visible" 
          [modal]="true" 
          [draggable]="false" 
          [resizable]="false"
          [style]="{width: '680px', maxWidth: '95vw'}"
          styleClass="cliente-dialog" 
          [baseZIndex]="1000"
          [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }"
          header=" Registrar Nuevo Cliente">
  
  <div class="dialog-content">
    <!-- Mensajes de alerta -->
    <div *ngIf="mensajeError" class="alert alert-danger">
      {{ mensajeError }}
    </div>
    <div *ngIf="mensajeExito" class="alert alert-success">
      {{ mensajeExito }}
    </div>
    
    <!-- Tipo de cliente -->
    <div class="client-type-section">
      <h3 class="section-title">Tipo de cliente</h3>
      <div class="selection-options">
        <div class="selection-option" [class.selected]="isPersonaNatural">
          <label class="selection-option-label">
            <input type="radio" name="tipoCliente" [checked]="isPersonaNatural" (change)="toggleClienteType(true)">
            <span class="selection-radio"></span>
            <span class="selection-text">Persona Natural</span>
          </label>
        </div>
        <div class="selection-option" [class.selected]="!isPersonaNatural">
          <label class="selection-option-label">
            <input type="radio" name="tipoCliente" [checked]="!isPersonaNatural" (change)="toggleClienteType(false)">
            <span class="selection-radio"></span>
            <span class="selection-text">Empresa</span>
          </label>
        </div>
      </div>
    </div>
    
    <!-- Tipo de documento -->
    <div class="document-type-section" *ngIf="mostrarTipoDocumento">
      <h3 class="section-title">Tipo de documento</h3>
      <div class="selection-options">
        <div class="selection-option" *ngIf="isPersonaNatural" [class.selected]="tipoDocumento === 'cedula'">
          <label class="selection-option-label">
            <input type="radio" name="tipoDocumento" [checked]="tipoDocumento === 'cedula'" (change)="cambiarTipoDocumento('cedula')">
            <span class="selection-radio"></span>
            <span class="selection-text">Cédula</span>
          </label>
        </div>
        <div class="selection-option" *ngIf="isPersonaNatural" [class.selected]="tipoDocumento === 'pasaporte'">
          <label class="selection-option-label">
            <input type="radio" name="tipoDocumento" [checked]="tipoDocumento === 'pasaporte'" (change)="cambiarTipoDocumento('pasaporte')">
            <span class="selection-radio"></span>
            <span class="selection-text">Pasaporte</span>
          </label>
        </div>
        <div class="selection-option" *ngIf="!isPersonaNatural" [class.selected]="tipoDocumento === 'ruc'">
          <label class="selection-option-label">
            <input type="radio" name="tipoDocumento" [checked]="tipoDocumento === 'ruc'" (change)="cambiarTipoDocumento('ruc')">
            <span class="selection-radio"></span>
            <span class="selection-text">RUC</span>
          </label>
        </div>
      </div>
    </div>
    
    <!-- Formulario para Persona Natural -->
    <div class="form-section" *ngIf="mostrarCamposPersonaNatural">
      <div class="tabs-nav">
        <button type="button" class="tab-button" [class.active]="activeTab === 'informacion'" (click)="activeTab = 'informacion'">
          <i class="pi pi-user tab-icon"></i> Información Básica
        </button>
        <button type="button" class="tab-button" [class.active]="activeTab === 'contacto'" (click)="activeTab = 'contacto'">
          <i class="pi pi-envelope tab-icon"></i> Contacto
        </button>
      </div>
      
      <!-- Tab de Información Básica - Persona Natural -->
      <div class="form-fields" *ngIf="activeTab === 'informacion'">
        <div class="form-field">
          <label class="form-label required" for="documentoPN">Número de documento</label>
          <input id="documentoPN" class="form-input" type="text" [(ngModel)]="datosPersonaNatural.documento" name="documentoPN" placeholder="Ingrese número de documento">
          <span class="form-hint">Ingrese el número sin guiones</span>
        </div>
        
        <div class="form-row">
          <div class="form-field">
            <label class="form-label required" for="nombres">Nombres</label>
            <input id="nombres" class="form-input" type="text" [(ngModel)]="datosPersonaNatural.nombres" name="nombres" placeholder="Nombres completos">
          </div>
          
          <div class="form-field">
            <label class="form-label required" for="apellidos">Apellidos</label>
            <input id="apellidos" class="form-input" type="text" [(ngModel)]="datosPersonaNatural.apellidos" name="apellidos" placeholder="Apellidos completos">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-field">
            <label class="form-label" for="fechaNacimiento">Fecha de nacimiento</label>
            <input id="fechaNacimiento" class="form-input" type="date" [(ngModel)]="datosPersonaNatural.fechaNacimiento" name="fechaNacimiento">
          </div>
          
          <div class="form-field">
            <label class="form-label" for="genero">Género</label>
            <select id="genero" class="form-input" [(ngModel)]="datosPersonaNatural.genero" name="genero">
              <option value="">Seleccionar</option>
              <option value="masculino">Masculino</option>
              <option value="femenino">Femenino</option>
              <option value="otro">Otro</option>
            </select>
          </div>
        </div>
      </div>
      
      <!-- Tab de Contacto - Persona Natural -->
      <div class="form-fields" *ngIf="activeTab === 'contacto'">
        <div class="form-row">
          <div class="form-field">
            <label class="form-label required" for="email">Email</label>
            <input id="email" class="form-input" type="email" [(ngModel)]="datosPersonaNatural.email" name="email" placeholder="correo@ejemplo.com">
          </div>
          
          <div class="form-field">
            <label class="form-label" for="celular">Celular</label>
            <input id="celular" class="form-input" type="tel" [(ngModel)]="datosPersonaNatural.celular" name="celular" placeholder="+593 00 000 0000">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-field">
            <label class="form-label" for="telefono">Teléfono</label>
            <input id="telefono" class="form-input" type="tel" [(ngModel)]="datosPersonaNatural.telefono" name="telefono" placeholder="02 000 0000">
          </div>
          
          <div class="form-field">
            <label class="form-label required" for="direccion">Dirección</label>
            <input id="direccion" class="form-input" type="text" [(ngModel)]="datosPersonaNatural.direccion" name="direccion" placeholder="Dirección completa">
          </div>
        </div>
        
        <div class="form-field">
          <label class="form-label">Es Local</label>
          <div class="selection-options">
            <div class="selection-option" [class.selected]="datosPersonaNatural.esLocal">
              <label class="selection-option-label">
                <input type="radio" name="esLocalPN" [checked]="datosPersonaNatural.esLocal" (change)="datosPersonaNatural.esLocal = true">
                <span class="selection-radio"></span>
                <span class="selection-text">Sí</span>
              </label>
            </div>
            <div class="selection-option" [class.selected]="!datosPersonaNatural.esLocal">
              <label class="selection-option-label">
                <input type="radio" name="esLocalPN" [checked]="!datosPersonaNatural.esLocal" (change)="datosPersonaNatural.esLocal = false">
                <span class="selection-radio"></span>
                <span class="selection-text">No</span>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Formulario para Empresa -->
    <div class="form-section" *ngIf="mostrarCamposEmpresa">
      <div class="tabs-nav">
        <button type="button" class="tab-button" [class.active]="activeTab === 'informacion'" (click)="activeTab = 'informacion'">
          <i class="pi pi-building tab-icon"></i> Información Básica
        </button>
        <button type="button" class="tab-button" [class.active]="activeTab === 'contacto'" (click)="activeTab = 'contacto'">
          <i class="pi pi-envelope tab-icon"></i> Contacto
        </button>
        <button type="button" class="tab-button" [class.active]="activeTab === 'adicional'" (click)="activeTab = 'adicional'">
          <i class="pi pi-file tab-icon"></i> Adicional
        </button>
      </div>
      
      <!-- Tab de Información Básica - Empresa -->
      <div class="form-fields" *ngIf="activeTab === 'informacion'">
        <div class="form-field">
          <label class="form-label required" for="documentoEmpresa">Número de documento</label>
          <input id="documentoEmpresa" class="form-input" type="text" [(ngModel)]="datosEmpresa.documento" name="documentoEmpresa" placeholder="Ingrese número de RUC">
          <span class="form-hint">Ingrese los 13 dígitos sin guiones</span>
        </div>
        
        <div class="form-row">
          <div class="form-field">
            <label class="form-label required" for="nombreEmpresa">Nombre</label>
            <input id="nombreEmpresa" class="form-input" type="text" [(ngModel)]="datosEmpresa.nombre" name="nombreEmpresa" placeholder="Nombre comercial">
          </div>
          
          <div class="form-field">
            <label class="form-label required" for="razonSocial">Razón social</label>
            <input id="razonSocial" class="form-input" type="text" [(ngModel)]="datosEmpresa.razonSocial" name="razonSocial" placeholder="Razón social completa">
          </div>
        </div>
        
        <div class="form-field">
          <label class="form-label required" for="representanteLegal">Nombre representante legal</label>
          <input id="representanteLegal" class="form-input" type="text" [(ngModel)]="datosEmpresa.representanteLegal" name="representanteLegal" placeholder="Nombre completo del representante">
        </div>
      </div>
      
      <!-- Tab de Contacto - Empresa -->
      <div class="form-fields" *ngIf="activeTab === 'contacto'">
        <div class="form-row">
          <div class="form-field">
            <label class="form-label required" for="emailEmpresa">Email</label>
            <input id="emailEmpresa" class="form-input" type="email" [(ngModel)]="datosEmpresa.email" name="emailEmpresa" placeholder="empresa@ejemplo.com">
          </div>
          
          <div class="form-field">
            <label class="form-label" for="celularEmpresa">Celular</label>
            <input id="celularEmpresa" class="form-input" type="tel" [(ngModel)]="datosEmpresa.celular" name="celularEmpresa" placeholder="+593 00 000 0000">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-field">
            <label class="form-label" for="telefonoEmpresa">Teléfono</label>
            <input id="telefonoEmpresa" class="form-input" type="tel" [(ngModel)]="datosEmpresa.telefono" name="telefonoEmpresa" placeholder="02 000 0000">
          </div>
          
          <div class="form-field">
            <label class="form-label required" for="direccionEmpresa">Dirección</label>
            <input id="direccionEmpresa" class="form-input" type="text" [(ngModel)]="datosEmpresa.direccion" name="direccionEmpresa" placeholder="Dirección completa">
          </div>
        </div>
      </div>
      
      <!-- Tab Adicional - Empresa -->
      <div class="form-fields" *ngIf="activeTab === 'adicional'">
        <div class="form-row">
          <div class="form-field">
            <label class="form-label">Obligada contabilidad</label>
            <div class="selection-options">
              <div class="selection-option" [class.selected]="datosEmpresa.obligadaContabilidad">
                <label class="selection-option-label">
                  <input type="radio" name="obligadaContabilidad" [checked]="datosEmpresa.obligadaContabilidad" (change)="datosEmpresa.obligadaContabilidad = true">
                  <span class="selection-radio"></span>
                  <span class="selection-text">Sí</span>
                </label>
              </div>
              <div class="selection-option" [class.selected]="!datosEmpresa.obligadaContabilidad">
                <label class="selection-option-label">
                  <input type="radio" name="obligadaContabilidad" [checked]="!datosEmpresa.obligadaContabilidad" (change)="datosEmpresa.obligadaContabilidad = false">
                  <span class="selection-radio"></span>
                  <span class="selection-text">No</span>
                </label>
              </div>
            </div>
          </div>
          
          <div class="form-field">
            <label class="form-label">Es Local</label>
            <div class="selection-options">
              <div class="selection-option" [class.selected]="datosEmpresa.esLocal">
                <label class="selection-option-label">
                  <input type="radio" name="esLocal" [checked]="datosEmpresa.esLocal" (change)="datosEmpresa.esLocal = true">
                  <span class="selection-radio"></span>
                  <span class="selection-text">Sí</span>
                </label>
              </div>
              <div class="selection-option" [class.selected]="!datosEmpresa.esLocal">
                <label class="selection-option-label">
                  <input type="radio" name="esLocal" [checked]="!datosEmpresa.esLocal" (change)="datosEmpresa.esLocal = false">
                  <span class="selection-radio"></span>
                  <span class="selection-text">No</span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Footer -->
  <div class="dialog-footer">
    <button type="button" class="btn-cancel" (click)="cerrarPopupPropietario()">
      <i class="pi pi-times"></i> Cancelar
    </button>
    <button type="button" class="btn-submit" [disabled]="cargando" (click)="registrarPropietario()">
      <i class="pi pi-save"></i>
      <span *ngIf="cargando">Registrando...</span>
      <span *ngIf="!cargando">Registrar</span>
    </button>
  </div>
</p-dialog>
<!-- Modal para nuevo vehiculo -->
<p-dialog [(visible)]="visibleVehiculo" 
[modal]="true" 
[draggable]="false" 
[resizable]="false"
[style]="{ width: '650px', padding: '0', margin: '0', maxHeight: '90vh' }"
styleClass="vehiculo-dialog light-theme" 
[showHeader]="false" 
[closable]="false" 
[baseZIndex]="1000">
  
<!-- Header personalizado -->
<div class="popup-header light">
  <h2 class="popup-title">Registrar Nuevo Vehículo</h2>
  <button type="button" class="close-button" (click)="cerrarPopupVehiculo()">✕</button>
</div>

<!-- Content -->
<div class="popup-content light">
  <form >
    <div class="form-group">
      <label for="placa" class="form-label">Número de Placa:</label>
      <input type="text" id="placa" class="form-input"  name="placa">
    </div>
    
    <div class="form-row">
      <div class="form-group required">
        <label for="marca" class="form-label">Marca<span class="required-indicator"></span></label>
        <input type="text" id="marca" class="form-input"  name="marca" required>
      </div>
      
      <div class="form-group required">
        <label for="modelo" class="form-label">Modelo<span class="required-indicator"></span></label>
        <input type="text" id="modelo" class="form-input"  name="modelo" required>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="version" class="form-label">Versión</label>
        <input type="text" id="version" class="form-input"  name="version">
      </div>
      
      <div class="form-group required">
        <label for="ano" class="form-label">Año<span class="required-indicator"></span></label>
        <input type="number" id="ano" class="form-input"  name="ano" required>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="chasis" class="form-label">Número de Chasis</label>
        <input type="text" id="chasis" class="form-input"  name="chasis">
      </div>
      
      <div class="form-group required">
        <label for="color" class="form-label">Color<span class="required-indicator"></span></label>
        <input type="text" id="color" class="form-input"  name="color" required>
      </div>
    </div>
    
    <div class="form-group">
      <label for="tipoVehiculo" class="form-label">Tipo de Vehículo</label>
    </div>
  </form>
</div>

<div class="buttons-container light">
  <button type="button" class="btn btn-cancel light" (click)="cerrarPopupVehiculo()">Cancelar</button>
  <button type="button" class="btn btn-submit light" >Registrar</button>
</div>
</p-dialog>