<div class="header-container">
    <div class="home-icon">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        <polyline points="9 22 9 12 15 12 15 22"></polyline>
      </svg>
    </div>
    <div class="user-info">
      <span>Usuario: Bryan Alexander Baño Riofrio(Admin)</span>
    </div>
</div>
<!-- Agregar seleccionar Cliente -->
<div class="block-container">
  <h2 class="block-title">Agregar o Seleccionar un cliente</h2>
  
  <div class="block-content">
    <div class="input-group">
      <label for="documento">Ingrese el número del documento:</label>
      <div class="input-with-button">
        <input type="text" id="documento" placeholder="Ingrese documento" [(ngModel)]="documento">
        <button class="validar-btn" (click)="validarCliente()" [disabled]="cargandoCliente">
          <span *ngIf="!cargandoCliente">Validar</span>
          <span *ngIf="cargandoCliente">Cargando...</span>
        </button>
      </div>
    </div>

    <!-- Sección de información del cliente (condicional) -->
    <div class="info-section" *ngIf="mostrarInfoCliente && clienteActual">
      <div class="info-item">
        <p><strong>Nombre completo:</strong> {{clienteActual.nombreCompleto}}</p>
        <p><strong>Documento:</strong> {{clienteActual.documento}}</p>
        <p><strong>Estado:</strong> 
          <span *ngIf="clienteActual.esClienteActivo" style="color: green;">Activo</span>
          <span *ngIf="!clienteActual.esClienteActivo" style="color: orange;">Inactivo</span>
        </p>
      </div>
    </div>
    
    <!-- Botón de nuevo propietario (siempre visible) -->
    <div class="actions" style="margin-top: 15px;">
      <button class="action-btn" (click)="showDialog($event)" type="button">
        Registrar Nuevo Cliente
      </button>
    </div>
  </div>
</div>
<!-- Agregar seleccionar vehiculo -->
<div class="block-container">
  <h2 class="block-title">Agregar o Seleccionar un Vehículo</h2>
  
  <div class="block-content">
    <div class="input-group">
      <label for="placa">Ingrese el número de placa del vehículo:</label>
      <div class="input-with-button">
        <input type="text" id="placa" placeholder="Ingrese la placa" [(ngModel)]="placa">
        <button class="validar-btn" (click)="validarVehiculo()" [disabled]="cargandoVehiculo">
          <span *ngIf="!cargandoVehiculo">Validar</span>
          <span *ngIf="cargandoVehiculo">Cargando...</span>
        </button>
        <button class="secondary-btn" [disabled]="!vehiculoActual">Retirar propiedad</button>
      </div>
    </div>
    <div class="info-section" *ngIf="mostrarInfoVehiculo && vehiculoActual">
      <div class="info-item">
        <p><strong>Placa:</strong> {{vehiculoActual.placa}}</p>
        <p><strong>Marca:</strong> {{vehiculoActual.marca}}</p>
        <p><strong>Modelo:</strong> {{vehiculoActual.modelo}}</p>
        <p><strong>Último año de matriculación:</strong> {{vehiculoActual.ultimoAnioMatriculacion}}</p>
        <p><strong>Último año de RTV:</strong> {{vehiculoActual.ultimoAnioRTV}}</p>
        <p><strong>Estado:</strong> 
          <span *ngIf="vehiculoActual.estado == 0" style="color: green;">Operativo</span>
          <span *ngIf="vehiculoActual.estado == 1" style="color: orange;">En Mantenimiento</span>
          <span *ngIf="vehiculoActual.estado == 2" style="color: red;">De Baja</span>
        </p>
      </div>
    </div>
    
    <!-- Botón para nuevo vehículo (siempre visible) -->
    <div class="actions" style="margin-top: 15px;">
      <button class="action-btn" (click)="mostrarPopupVehiculo()">Nuevo Vehículo</button>
    </div>
  </div>
</div>
<!-- Servicio a realizar -->
<div class="service-container">
  <h2 class="service-title">Servicio a Realizar</h2>
  <div class="service-content">
    <div class="section-group">
      <h3 class="section-subtitle">Detalles del Servicio</h3>
      <div class="form-grid">
        <div class="form-group">
          <label for="descripcion">Descripción del mantenimiento:*</label>
          <textarea id="descripcion" rows="3" [(ngModel)]="ordenData.detalle" required placeholder="Describa detalladamente el mantenimiento a realizar"></textarea>
        </div>
        
        <div class="form-group">
          <label for="observacion">Observación General (opcional)*</label>
          <textarea id="observacion" rows="3" [(ngModel)]="ordenData.observacion" placeholder="Información adicional sobre el servicio"></textarea>
        </div>
      </div>
    </div>
    
    <div class="section-group">
      <h3 class="section-subtitle">Información Técnica</h3>
      <div class="form-grid">
        <div class="form-group">
          <label for="kilometraje">Kilometraje actual:*</label>
          <div class="input-with-unit">
            <input type="number" id="kilometraje" [(ngModel)]="ordenData.kilometraje" required placeholder="Ej: 15000">
            <span class="unit">km</span>
          </div>
        </div>
        
        <div class="form-group">
          <label for="fecha">Fecha programada:*</label>
          <div class="date-input">
            <input type="date" id="fecha" [(ngModel)]="ordenData.fechaProgramada" required>
            
          </div>
        </div>
      </div>
    </div>
    
    <div class="section-group">
      <h3 class="section-subtitle">Asignación y Prioridad</h3>
      <div class="form-grid">
        <!-- Mecánico Asignado con estado de carga -->
          <div class="form-group">
            <label for="mecanico">Mecánico Asignado (supervisor)*</label>
            <div class="select-wrapper">
              <select id="mecanico" [(ngModel)]="ordenData.idMecanico" required [disabled]="cargandoMecanicos">
                <option value="" disabled selected>
                  {{cargandoMecanicos ? 'Cargando mecánicos...' : 'Seleccionar mecánico...'}}
                </option>
                <option *ngFor="let mecanico of mecanicos" [value]="mecanico.idMecanico">
                  {{mecanico.nombre}}
                </option>
              </select>
              <div class="select-arrow" *ngIf="!cargandoMecanicos">▼</div>
              <div class="loading-indicator" *ngIf="cargandoMecanicos">
                <span class="spinner"></span>
              </div>
            </div>
          </div>
        
        <div class="form-group">
          <label for="prioridad">Prioridad de la Orden:*</label>
          <div class="select-wrapper">
            <select id="prioridad" [(ngModel)]="ordenData.prioridad" required>
              <option value="" disabled selected>Seleccionar prioridad...</option>
              <option [value]="0" class="priority-critical">Crítico</option>
              <option [value]="1" class="priority-emergency">Emergencia</option>
              <option [value]="2" class="priority-warning">Advertencia</option>
              <option [value]="3" class="priority-notification">Notificación</option>
              <option [value]="4" class="priority-low">Baja prioridad</option>
            </select>
            <div class="select-arrow">▼</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Sección de imágenes -->
    <div class="section-group">
      <h3 class="section-subtitle">Imágenes de Recepción del Vehículo</h3>
      <p class="section-description">Adjunte fotografías del vehículo para documentar su estado. Las imágenes se subirán después de crear la orden.</p>
      
      <div class="image-grid">
        <!-- Imagen Frontal (Ya implementada) -->
        <div class="image-upload-box" 
            [class.with-image]="previewFrontal"
            [class.dragover]="dragOverFrontal"
            (dragover)="onDragOver($event); dragOverFrontal = true"
            (dragleave)="dragOverFrontal = false"
            (drop)="onDrop($event, 'frontal'); dragOverFrontal = false">
          
          <h4>Frontal</h4>
          
          <!-- Vista previa cuando hay imagen -->
          <div class="image-preview" *ngIf="previewFrontal">
            <img [src]="previewFrontal" alt="Vista previa frontal">
            <button type="button" class="remove-image" (click)="eliminarImagen('frontal')">
              <i class="delete-icon">×</i>
            </button>
          </div>
          
          <!-- Área de drop cuando no hay imagen -->
          <ng-container *ngIf="!previewFrontal">
            <div class="image-icons">
              <div class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2"/>
                  <circle cx="8.5" cy="8.5" r="1.5"/>
                  <path d="M20.4 14.5L16 10 4 20"/>
                </svg>
              </div>
              <div class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                  <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
                </svg>
              </div>
              <div class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                </svg>
              </div>
            </div>
            <p class="drop-text">Arrastra una imagen aquí</p>
            <div class="action-buttons">
              <label class="browse-button">
                <span>Seleccionar</span>
                <input type="file" accept="image/*" (change)="onFileSelected($event, 'frontal')" style="display:none">
              </label>
              <!-- Modifica temporalmente esto -->
              <label class="camera-button"> <!-- Quitar *ngIf="isMobileDevice()" durante pruebas -->
                <span>Cámara</span>
                <input type="file" accept="image/*" capture="environment" (change)="onFileSelected($event, 'frontal')" style="display:none">
              </label>
            </div>
          </ng-container>
        </div>
        <!-- Imagen Lateral Izquierda -->
          <div class="image-upload-box" 
          [class.with-image]="previewLateralIzquierda"
          [class.dragover]="dragOverLateralIzquierda"
          (dragover)="onDragOver($event); dragOverLateralIzquierda = true"
          (dragleave)="dragOverLateralIzquierda = false"
          (drop)="onDrop($event, 'lateralIzquierda'); dragOverLateralIzquierda = false">

          <h4>Lateral Izquierda</h4>

          <!-- Vista previa cuando hay imagen -->
          <div class="image-preview" *ngIf="previewLateralIzquierda">
          <img [src]="previewLateralIzquierda" alt="Vista previa lateral izquierda">
          <button type="button" class="remove-image" (click)="eliminarImagen('lateralIzquierda')">
            <i class="delete-icon">×</i>
          </button>
          </div>

          <!-- Área de drop cuando no hay imagen -->
          <ng-container *ngIf="!previewLateralIzquierda">
          <div class="image-icons">
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <path d="M20.4 14.5L16 10 4 20"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
              </svg>
            </div>
          </div>
          <p class="drop-text">Arrastra una imagen aquí</p>
          <div class="action-buttons">
            <label class="browse-button">
              <span>Seleccionar</span>
              <input type="file" accept="image/*" (change)="onFileSelected($event, 'lateralIzquierda')" style="display:none">
            </label>
            <label class="camera-button">
              <span>Cámara</span>
              <input type="file" accept="image/*" capture="environment" (change)="onFileSelected($event, 'lateralIzquierda')" style="display:none">
            </label>
          </div>
          </ng-container>
          </div>

          <!-- Imagen Lateral Derecha -->
          <div class="image-upload-box" 
          [class.with-image]="previewLateralDerecha"
          [class.dragover]="dragOverLateralDerecha"
          (dragover)="onDragOver($event); dragOverLateralDerecha = true"
          (dragleave)="dragOverLateralDerecha = false"
          (drop)="onDrop($event, 'lateralDerecha'); dragOverLateralDerecha = false">

          <h4>Lateral Derecha</h4>

          <!-- Vista previa cuando hay imagen -->
          <div class="image-preview" *ngIf="previewLateralDerecha">
          <img [src]="previewLateralDerecha" alt="Vista previa lateral derecha">
          <button type="button" class="remove-image" (click)="eliminarImagen('lateralDerecha')">
            <i class="delete-icon">×</i>
          </button>
          </div>

          <!-- Área de drop cuando no hay imagen -->
          <ng-container *ngIf="!previewLateralDerecha">
          <div class="image-icons">
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <path d="M20.4 14.5L16 10 4 20"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
              </svg>
            </div>
          </div>
          <p class="drop-text">Arrastra una imagen aquí</p>
          <div class="action-buttons">
            <label class="browse-button">
              <span>Seleccionar</span>
              <input type="file" accept="image/*" (change)="onFileSelected($event, 'lateralDerecha')" style="display:none">
            </label>
            <label class="camera-button">
              <span>Cámara</span>
              <input type="file" accept="image/*" capture="environment" (change)="onFileSelected($event, 'lateralDerecha')" style="display:none">
            </label>
          </div>
          </ng-container>
          </div>

          <!-- Imagen Trasera -->
          <div class="image-upload-box" 
          [class.with-image]="previewTrasera"
          [class.dragover]="dragOverTrasera"
          (dragover)="onDragOver($event); dragOverTrasera = true"
          (dragleave)="dragOverTrasera = false"
          (drop)="onDrop($event, 'trasera'); dragOverTrasera = false">

          <h4>Trasera</h4>

          <!-- Vista previa cuando hay imagen -->
          <div class="image-preview" *ngIf="previewTrasera">
          <img [src]="previewTrasera" alt="Vista previa trasera">
          <button type="button" class="remove-image" (click)="eliminarImagen('trasera')">
            <i class="delete-icon">×</i>
          </button>
          </div>

          <!-- Área de drop cuando no hay imagen -->
          <ng-container *ngIf="!previewTrasera">
          <div class="image-icons">
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <path d="M20.4 14.5L16 10 4 20"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
              </svg>
            </div>
            <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
              </svg>
            </div>
          </div>
          <p class="drop-text">Arrastra una imagen aquí</p>
          <div class="action-buttons">
            <label class="browse-button">
              <span>Seleccionar</span>
              <input type="file" accept="image/*" (change)="onFileSelected($event, 'trasera')" style="display:none">
            </label>
            <label class="camera-button">
              <span>Cámara</span>
              <input type="file" accept="image/*" capture="environment" (change)="onFileSelected($event, 'trasera')" style="display:none">
            </label>
          </div>
          </ng-container>
          </div>
      </div>
      <!-- Indicador de carga de imágenes -->
      <div class="upload-status" *ngIf="cargandoImagenes">
        <div class="progress-bar">
          <div class="progress" [style.width.%]="(imagenesSubidas / totalImagenes) * 100"></div>
        </div>
        <p>Subiendo imágenes: {{imagenesSubidas}} de {{totalImagenes}}</p>
      </div>
    </div>

    <!-- Agregar al final del servicio-container -->
    <div class="actions-container">
      <button type="button" class="cancel-btn" (click)="navegarInicio()" [disabled]="creandoOrden || cargandoImagenes">
        Cancelar
      </button>
      
      <button type="button" class="create-btn" [disabled]="creandoOrden || cargandoImagenes" (click)="crearOrdenTrabajo()">
        <span *ngIf="!creandoOrden && !cargandoImagenes">Crear Orden de Trabajo</span>
        <span *ngIf="creandoOrden && !cargandoImagenes">
          <span class="spinner"></span> Creando orden...
        </span>
        <span *ngIf="cargandoImagenes">
          <span class="spinner"></span> Subiendo imágenes... ({{imagenesSubidas}}/{{totalImagenes}})
        </span>
      </button>
    </div>
  </div>
</div>


<!-- Modal para Nuevo Propietario -->
<p-dialog [(visible)]="visible" 
[modal]="true" 
[draggable]="false" 
[resizable]="false"
[style]="{ width: '800px', padding: '0', margin: '0', maxHeight: '90vh' }"
styleClass="custom-dialog" 
[showHeader]="false" 
[closable]="false" 
[baseZIndex]="1000">
  
<!-- Header personalizado -->
<div class="popup-header">
  <h2 class="popup-title">Registrar Nuevo Cliente</h2>
  <button type="button" class="close-button" (click)="cerrarPopupPropietario()">✕</button>
</div>

<!-- Mensajes de error/éxito -->
<div *ngIf="mensajeError" class="alert alert-danger">
  {{ mensajeError }}
</div>
<div *ngIf="mensajeExito" class="alert alert-success">
  {{ mensajeExito }}
</div>

<!-- Content -->
<div class="popup-content">
  <form (ngSubmit)="registrarPropietario()">
    <!-- Separar los selectores en dos filas independientes -->
    <div class="selector-group">
      <div class="selector-header">
        <span class="selector-title">Tipo de cliente</span>
      </div>
      <div class="selector-options">
        <div class="selector-option">
          <input type="radio" id="personaNatural" name="tipoCliente" class="selector-input"
                  [checked]="isPersonaNatural"
                  (change)="toggleClienteType(true)">
          <label for="personaNatural" class="selector-label">Persona Natural</label>
        </div>
        <div class="selector-option">
          <input type="radio" id="empresa" name="tipoCliente" class="selector-input"
                  [checked]="!isPersonaNatural"
                  (change)="toggleClienteType(false)">
          <label for="empresa" class="selector-label">Empresa</label>
        </div>
      </div>
    </div>
    
    <div class="selector-group" *ngIf="mostrarTipoDocumento">
      <div class="selector-header">
        <span class="selector-title">Tipo de documento</span>
      </div>
      <div class="selector-options">
        <div class="selector-option" *ngIf="isPersonaNatural">
          <input type="radio" id="cedula" name="documento" class="selector-input"
                 [checked]="tipoDocumento === 'cedula'"
                 (change)="cambiarTipoDocumento('cedula')">
          <label for="cedula" class="selector-label">Cédula</label>
        </div>
        <div class="selector-option" *ngIf="isPersonaNatural">
          <input type="radio" id="pasaporte" name="documento" class="selector-input"
                 [checked]="tipoDocumento === 'pasaporte'"
                 (change)="cambiarTipoDocumento('pasaporte')">
          <label for="pasaporte" class="selector-label">Pasaporte</label>
        </div>
        <div class="selector-option" *ngIf="!isPersonaNatural">
          <input type="radio" id="ruc" name="documento" class="selector-input"
                 [checked]="tipoDocumento === 'ruc'"
                 (change)="cambiarTipoDocumento('ruc')">
          <label for="ruc" class="selector-label">RUC</label>
        </div>
      </div>
    </div>
    
    <!-- Campos Persona Natural -->
    <div *ngIf="mostrarCamposPersonaNatural">
      <div class="tabs">
        <div class="tab" [class.active]="activeTab === 'informacion'" (click)="activeTab = 'informacion'">Información Básica</div>
        <div class="tab" [class.active]="activeTab === 'contacto'" (click)="activeTab = 'contacto'">Contacto</div>
      </div>
      
      <div class="tab-content" [class.active]="activeTab === 'informacion'">
        <div class="form-group required">
          <label for="documentoPN" class="form-label">Número de documento</label>
          <input type="text" id="documentoPN" class="form-input" [(ngModel)]="datosPersonaNatural.documento" name="documentoPN">
        </div>
        
        <div class="form-row">
          <div class="form-group required">
            <label for="nombres" class="form-label">Nombres</label>
            <input type="text" id="nombres" class="form-input" [(ngModel)]="datosPersonaNatural.nombres" name="nombres">
          </div>
          
          <div class="form-group required">
            <label for="apellidos" class="form-label">Apellidos</label>
            <input type="text" id="apellidos" class="form-input" [(ngModel)]="datosPersonaNatural.apellidos" name="apellidos">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="fechaNacimiento" class="form-label">Fecha de nacimiento</label>
            <input type="date" id="fechaNacimiento" class="form-input" [(ngModel)]="datosPersonaNatural.fechaNacimiento" name="fechaNacimiento">
          </div>
          
          <div class="form-group">
            <label for="genero" class="form-label">Género</label>
            <select id="genero" class="form-input" [(ngModel)]="datosPersonaNatural.genero" name="genero">
              <option value="">Seleccionar</option>
              <option value="masculino">Masculino</option>
              <option value="femenino">Femenino</option>
              <option value="otro">Otro</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="tab-content" [class.active]="activeTab === 'contacto'">
        <div class="form-row">
          <div class="form-group required">
            <label for="email" class="form-label">Email</label>
            <input type="email" id="email" class="form-input" [(ngModel)]="datosPersonaNatural.email" name="email">
          </div>
          
          <div class="form-group">
            <label for="celular" class="form-label">Celular</label>
            <input type="tel" id="celular" class="form-input w-full" [(ngModel)]="datosPersonaNatural.celular" name="celular" fluid>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="telefono" class="form-label">Teléfono</label>
            <input type="tel" id="telefono" class="form-input" [(ngModel)]="datosPersonaNatural.telefono" name="telefono">
          </div>
          
          <div class="form-group required">
            <label for="direccion" class="form-label">Dirección</label>
            <input type="text" id="direccion" class="form-input" [(ngModel)]="datosPersonaNatural.direccion" name="direccion">
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Es Local</label>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="localSiPN" name="esLocalPN" class="radio-input"
                     [checked]="datosPersonaNatural.esLocal"
                     (change)="datosPersonaNatural.esLocal = true">
              <label for="localSiPN" class="form-label">Sí</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="localNoPN" name="esLocalPN" class="radio-input"
                     [checked]="!datosPersonaNatural.esLocal"
                     (change)="datosPersonaNatural.esLocal = false">
              <label for="localNoPN" class="form-label">No</label>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Campos Empresa -->
    <div *ngIf="mostrarCamposEmpresa">
      <div class="tabs">
        <div class="tab" [class.active]="activeTab === 'informacion'" (click)="activeTab = 'informacion'">Información Básica</div>
        <div class="tab" [class.active]="activeTab === 'contacto'" (click)="activeTab = 'contacto'">Contacto</div>
        <div class="tab" [class.active]="activeTab === 'adicional'" (click)="activeTab = 'adicional'">Adicional</div>
      </div>
      
      <div class="tab-content" [class.active]="activeTab === 'informacion'">
        <div class="form-group required">
          <label for="documentoEmpresa" class="form-label">Número de documento</label>
          <input type="text" id="documentoEmpresa" class="form-input" [(ngModel)]="datosEmpresa.documento" name="documentoEmpresa">
        </div>
        
        <div class="form-row">
          <div class="form-group required">
            <label for="nombreEmpresa" class="form-label">Nombre</label>
            <input type="text" id="nombreEmpresa" class="form-input" [(ngModel)]="datosEmpresa.nombre" name="nombreEmpresa">
          </div>
          
          <div class="form-group required">
            <label for="razonSocial" class="form-label">Razón social</label>
            <input type="text" id="razonSocial" class="form-input" [(ngModel)]="datosEmpresa.razonSocial" name="razonSocial">
          </div>
        </div>
        
        <div class="form-group required">
          <label for="representanteLegal" class="form-label">Nombre representante legal</label>
          <input type="text" id="representanteLegal" class="form-input" [(ngModel)]="datosEmpresa.representanteLegal" name="representanteLegal">
        </div>
      </div>
      
      <div class="tab-content" [class.active]="activeTab === 'contacto'">
        <div class="form-row">
          <div class="form-group required">
            <label for="emailEmpresa" class="form-label">Email</label>
            <input type="email" id="emailEmpresa" class="form-input" [(ngModel)]="datosEmpresa.email" name="emailEmpresa">
          </div>
          
          <div class="form-group">
            <label for="celularEmpresa" class="form-label">Celular</label>
            <input type="tel" id="celularEmpresa" class="form-input" [(ngModel)]="datosEmpresa.celular" name="celularEmpresa">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="telefonoEmpresa" class="form-label">Teléfono</label>
            <input type="tel" id="telefonoEmpresa" class="form-input" [(ngModel)]="datosEmpresa.telefono" name="telefonoEmpresa">
          </div>
          
          <div class="form-group required">
            <label for="direccionEmpresa" class="form-label">Dirección</label>
            <input type="text" id="direccionEmpresa" class="form-input" [(ngModel)]="datosEmpresa.direccion" name="direccionEmpresa">
          </div>
        </div>
      </div>
      
      <div class="tab-content" [class.active]="activeTab === 'adicional'">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Obligada contabilidad</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" id="contabilidadSi" name="obligadaContabilidad" class="radio-input"
                       [checked]="datosEmpresa.obligadaContabilidad"
                       (change)="datosEmpresa.obligadaContabilidad = true">
                <label for="contabilidadSi" class="form-label">Sí</label>
              </div>
              <div class="radio-option">
                <input type="radio" id="contabilidadNo" name="obligadaContabilidad" class="radio-input"
                       [checked]="!datosEmpresa.obligadaContabilidad"
                       (change)="datosEmpresa.obligadaContabilidad = false">
                <label for="contabilidadNo" class="form-label">No</label>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Es Local</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" id="localSi" name="esLocal" class="radio-input"
                       [checked]="datosEmpresa.esLocal"
                       (change)="datosEmpresa.esLocal = true">
                <label for="localSi" class="form-label">Sí</label>
              </div>
              <div class="radio-option">
                <input type="radio" id="localNo" name="esLocal" class="radio-input"
                       [checked]="!datosEmpresa.esLocal"
                       (change)="datosEmpresa.esLocal = false">
                <label for="localNo" class="form-label">No</label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>

<!-- Botones de acción -->
<div class="buttons-container">
  <button type="button" class="btn btn-cancel" (click)="cerrarPopupPropietario()">Cancelar</button>
  <button type="button" class="btn btn-submit" [disabled]="cargando" (click)="registrarPropietario()">
    <span *ngIf="cargando">Registrando...</span>
    <span *ngIf="!cargando">Registrar</span>
  </button>
</div>
</p-dialog>
<!-- Modal para nuevo vehiculo -->
<p-dialog [(visible)]="visibleVehiculo" 
[modal]="true" 
[draggable]="false" 
[resizable]="false"
[style]="{ width: '650px', padding: '0', margin: '0', maxHeight: '90vh' }"
styleClass="vehiculo-dialog light-theme" 
[showHeader]="false" 
[closable]="false" 
[baseZIndex]="1000">
  
<!-- Header personalizado -->
<div class="popup-header light">
  <h2 class="popup-title">Registrar Nuevo Vehículo</h2>
  <button type="button" class="close-button" (click)="cerrarPopupVehiculo()">✕</button>
</div>

<!-- Content -->
<div class="popup-content light">
  <form >
    <div class="form-group">
      <label for="placa" class="form-label">Número de Placa:</label>
      <input type="text" id="placa" class="form-input"  name="placa">
    </div>
    
    <div class="form-row">
      <div class="form-group required">
        <label for="marca" class="form-label">Marca<span class="required-indicator"></span></label>
        <input type="text" id="marca" class="form-input"  name="marca" required>
      </div>
      
      <div class="form-group required">
        <label for="modelo" class="form-label">Modelo<span class="required-indicator"></span></label>
        <input type="text" id="modelo" class="form-input"  name="modelo" required>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="version" class="form-label">Versión</label>
        <input type="text" id="version" class="form-input"  name="version">
      </div>
      
      <div class="form-group required">
        <label for="ano" class="form-label">Año<span class="required-indicator"></span></label>
        <input type="number" id="ano" class="form-input"  name="ano" required>
      </div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label for="chasis" class="form-label">Número de Chasis</label>
        <input type="text" id="chasis" class="form-input"  name="chasis">
      </div>
      
      <div class="form-group required">
        <label for="color" class="form-label">Color<span class="required-indicator"></span></label>
        <input type="text" id="color" class="form-input"  name="color" required>
      </div>
    </div>
    
    <div class="form-group">
      <label for="tipoVehiculo" class="form-label">Tipo de Vehículo</label>
    </div>
  </form>
</div>

<div class="buttons-container light">
  <button type="button" class="btn btn-cancel light" (click)="cerrarPopupVehiculo()">Cancelar</button>
  <button type="button" class="btn btn-submit light" >Registrar</button>
</div>
</p-dialog>